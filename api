<VirtualHost *:80>

  ServerName       http://api.crossref.org:80

  ServerAdmin      labs@crossref.org
  ErrorLog         /var/log/apache2/api-error_log
  TransferLog      /var/log/apache2/api-access_log
  UseCanonicalName On

  RewriteEngine	   On
  RewriteRule	   /deposits(.*)	https://api.crossref.org/deposits$1 [R]

  ProxyRequests		Off
  ProxyPreserveHost	On

  <Proxy http://localhost:3001/*>
    Order deny,allow
    Allow from all
  </Proxy>

  ProxyPass        /  http://localhost:3001/
  ProxyPassReverse /  http://localhost:3001/

</VirtualHost>

<VirtualHost *:443>

  ServerName	https://api.crossref.org:443
  
  ServerAdmin		labs@crossref.org
  ErrorLog		/var/log/apache2/api-ssl-error_log
  TransferLog		/var/log/apache2/api-ssl-access_log
  UseCanonicalName	On

  SSLEngine			On
  SSLProtocol			all
  SSLCertificateFile		/etc/apache2/ssl/api_certificates/public.crt
  SSLCertificateKeyFile		/etc/apache2/ssl/api_certificates/api.crossref.org.key
  SSLCertificateChainFile	/etc/apache2/ssl/api_certificates/intermediate.crt

  ProxyRequests		Off	
  ProxyPreserveHost	On

  <Proxy http://localhost:3001/*>
    Order deny,allow
    Allow from all
  </Proxy>

  ProxyPass		/	http://localhost:3001/
  ProxyPassReverse	/	http://localhost:3001/


</VirtualHost>
